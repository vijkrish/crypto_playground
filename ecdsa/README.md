```
 python3 main.py
ECDSA Complete Workflow Demonstration
============================================================

==================== KEY GENERATION ====================
Generated private key: 48573207733769834784075443595295960313770015514025009678485973525846571369836
Generated public key: (11770238067211817422749060747887420614665031437290385111698355618645143194963, 36261682732847907792206382651694504568999876104146378776205119732042529814013)

==================== SIGNATURE GENERATION ====================
Message to sign: 'Hello, ECDSA! This is a secure message.'
Step 1: Hash the message to get h = 7468813973369168442685404919624435231683285455279041197688091077087701675390
Step 2: Generate random k = 77480986953407620536412620718541137747754167123036189650623251329468174068394
Step 3: Compute kG = (34405817295990688500303288025271602398293379622876440623132785247539666022607, 114586354308199978829935947324048950466529541532879913542524749044476024204468)
Step 4: Set r = x mod n = 34405817295990688500303288025271602398293379622876440623132785247539666022607
Step 5: Compute s = (h + rd) / k mod n = 28051605065006457798043740398015326102989982034082790851727540251382072873264
Step 6: The signature is (r, s) = (34405817295990688500303288025271602398293379622876440623132785247539666022607, 28051605065006457798043740398015326102989982034082790851727540251382072873264)

Signature (r, s): (34405817295990688500303288025271602398293379622876440623132785247539666022607, 28051605065006457798043740398015326102989982034082790851727540251382072873264)
Signature in hex: (0x4c1100a3565054f681373f47880bb1cfd0a49567cca9193d4910cbc1457af0cf, 0x3e04a5547011493499a258378311f03b7f45adc96b80f50f42b6d6d216ba1130)

==================== SIGNATURE VERIFICATION ====================
Step 1: Verified r and s are in range [1, n-1]
Step 2: Hash the message to get h = 7468813973369168442685404919624435231683285455279041197688091077087701675390
Step 3: Compute w = s^(-1) mod n = 9755158728904339669161174062012483546583935597193062710080281793798507952315
Step 4: Compute u1 = hw mod n = 13427302837812333731948079875161735553252478078427289475976167293549292160811
        Compute u2 = rw mod n = 22485185695980022001580265889879670987349365961989592798552612479154508935946
Step 5: Compute (x, y) = u1*G + u2*Q = (34405817295990688500303288025271602398293379622876440623132785247539666022607, 114586354308199978829935947324048950466529541532879913542524749044476024204468)
Step 6: Compute v = x mod n = 34405817295990688500303288025271602398293379622876440623132785247539666022607
        Check if v == r: 34405817295990688500303288025271602398293379622876440623132785247539666022607 == 34405817295990688500303288025271602398293379622876440623132785247539666022607

Verification result:
✓ Signature is VALID

==================== TAMPERED MESSAGE VERIFICATION ====================
Tampered message: 'Hello, ECDSA! This is a secure message. (tampered)'
Step 1: Verified r and s are in range [1, n-1]
Step 2: Hash the message to get h = 68073454860991681950261455285568674195259018661491931495086553037352192319373
Step 3: Compute w = s^(-1) mod n = 9755158728904339669161174062012483546583935597193062710080281793798507952315
Step 4: Compute u1 = hw mod n = 55871229425056259842271835091393537742941331820739215916262888016277582110414
        Compute u2 = rw mod n = 22485185695980022001580265889879670987349365961989592798552612479154508935946
Step 5: Compute (x, y) = u1*G + u2*Q = (38459333772851757862579748714195230779948057792203425272188058915518601335181, 89127239758120146687570616545071934543514240652160258986426902071266129758796)
Step 6: Compute v = x mod n = 38459333772851757862579748714195230779948057792203425272188058915518601335181
        Check if v == r: 38459333772851757862579748714195230779948057792203425272188058915518601335181 != 34405817295990688500303288025271602398293379622876440623132785247539666022607

Verification result for tampered message:
✗ Signature is INVALID (Expected for tampered message)

==================== SUMMARY ====================
The ECDSA workflow demonstrated:
1. Key Generation: Created a private/public key pair
2. Signature: Used private key to sign a message
3. Verification: Used public key to verify the signature
4. Security: Showed that changing the message invalidates the signature

This demonstrates the core properties of digital signatures:
- Authentication: Verifies who created the signature
- Integrity: Ensures the message hasn't been altered
- Non-repudiation: Signer cannot deny signing the message
```
